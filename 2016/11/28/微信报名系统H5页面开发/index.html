<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>微信报名系统H5页面开发 | Mark Miao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">微信报名系统H5页面开发</h1><a id="logo" href="/.">Mark Miao</a><p class="description">Mark’s blog</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">微信报名系统H5页面开发</h1><div class="post-meta">Nov 28, 2016<span> | </span><span class="category"><a href="/categories/HTML5/">HTML5</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#工具以及框架"><span class="toc-text">工具以及框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#微信分享调用和地图功能"><span class="toc-text">微信分享调用和地图功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分享功能重写，调用地图"><span class="toc-text">分享功能重写，调用地图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分享按钮显示-隐藏"><span class="toc-text">分享按钮显示/隐藏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MUI的Picker使用问题"><span class="toc-text">MUI的Picker使用问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#调用MUI的Picker"><span class="toc-text">调用MUI的Picker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PopPicker在软键盘弹出时不能完全隐藏"><span class="toc-text">PopPicker在软键盘弹出时不能完全隐藏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MUI的样式mui-min-css与微信的weui-min-css冲突"><span class="toc-text">MUI的样式mui.min.css与微信的weui.min.css冲突</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iOS第三方输入法遮盖输入框"><span class="toc-text">iOS第三方输入法遮盖输入框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#警示框的悬浮显示"><span class="toc-text">警示框的悬浮显示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#placeholder样式"><span class="toc-text">placeholder样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#正则使用"><span class="toc-text">正则使用</span></a></li></ol></div></div><div class="post-content"><p>工作需要，用HTML5写一个微信的内置网页，是一个参会报名流程。上次写html还是上学时交作业，现在着实有些手忙脚乱了，现学现用、磕磕绊绊，项目总算告一段落，到了要总结一下的时候了。简单记录了做这个项目时所遇到的问题，有些问题在网上能搜到解决办法，有些问题是为了实现效果耍的小聪明。</p>
<a id="more"></a>
<h2 id="工具以及框架"><a href="#工具以及框架" class="headerlink" title="工具以及框架"></a>工具以及框架</h2><p>由于我只负责h5界面(<del>让我负责java后台也做不来。我对好多语言都有兴趣，对java就是提不起兴趣，或许是因为大学学java学烦了。</del>)，所以就用了<a href="http://www.dcloud.io/" target="_blank" rel="external">HBuilder</a>只码web界面，这个开发工具开发h5网页来说很便利，比如它有代码提醒、边改边看模式、手机端网页运行、运行到iPhone上等等功能，但也有不好用的地方，比如快捷键、搜索方式等。</p>
<p>还有开发微信内置web网页必不可少的工具：<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784140&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">微信web开发者工具</a>。很不幸的说开发到中期才发现这个工具，明明就在微信JS-SDK下面就是视而不见。目前这个工具已经升级为开发小程序专用编译器，不能调试微信内置web页面。</p>
<p>当然还有谷歌浏览器Google Chrome，浏览器来说，我之前是火狐党，开发这个项目才用了谷歌浏览器。谷歌的开发者工具挺好用的，有错误调试，样式修改，多种手机屏幕调试。还有<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">微信JS-SDK说明文档</a>火狐浏览器上目录点击无效，谷歌浏览器就可以调转到相应内容。还有一点，项目中用到了一个别人写好的<code>picker</code>控件，在火狐浏览器上打开一团糟，谷歌浏览器完美运行，幸运的是微信内置浏览器也运行无误。重点说明：我不是火狐黑，项目之外依旧继续用火狐。这时可以感觉到web开发做浏览器兼容还是有很多工作的。</p>
<p>开发微信用的东西肯定要用微信提供的开发样式库<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784134&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">WeUI</a>，毕竟风格相近直接拿来用就行，即便是不一样，改起来也方便很多。包括微信的JS-SDK的<a href="http://203.195.235.76/jssdk/" target="_blank" rel="external">demo示例代码</a></p>
<p>还有号称最接近原生APP体验的高性能前端框架<a href="http://dev.dcloud.net.cn/mui/" target="_blank" rel="external">MUI</a>，项目中的picker就是用的这里的。</p>
<h2 id="微信分享调用和地图功能"><a href="#微信分享调用和地图功能" class="headerlink" title="微信分享调用和地图功能"></a>微信分享调用和地图功能</h2><h3 id="分享功能重写，调用地图"><a href="#分享功能重写，调用地图" class="headerlink" title="分享功能重写，调用地图"></a>分享功能重写，调用地图</h3><p>微信分享和地图调用都使用了微信提供的JS-SDK，公众平台有详细的说明文档。这里只记录一些调用步骤和遇到的问题。</p>
<p>微信分享不用单独去写，微信内置网页右上角会自动加入分享功能，默认分享出去的网页样式标题为页面标题，图片为网页中第一张图片，简介也是第一段文字。如果想自定义这些样式内容，就需要重写分享方法。</p>
<p>引入js文件，建议调用<code>https</code>的js地址，如果页面启用了<code>https</code>，使用<code>http</code>的js地址在iOS9中将无法调用sdk</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"https://res.wx.qq.com/open/js/jweixin-1.0.0.js"</span> type=<span class="string">"text/javascript"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>调用config方法，配置权限验证</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">wx.config(&#123;</div><div class="line">	<span class="attr">debug</span>: <span class="literal">true</span>,<span class="comment">//开启调试模式，一直有alert出现。发布页面时改为false</span></div><div class="line">	appId: <span class="string">'wx1234567890032222'</span>,<span class="comment">//微信公众号唯一标示。</span></div><div class="line">	timestamp: timestamp,<span class="comment">//时间戳</span></div><div class="line">	nonceStr: nonceStr,<span class="comment">//随机串</span></div><div class="line">	signature: signature,<span class="comment">//签名</span></div><div class="line">	jsApiList: [</div><div class="line">		<span class="string">'checkJsApi'</span>,<span class="comment">//验证客户端版本是否支持sdk</span></div><div class="line">		<span class="string">'onMenuShareTimeline'</span>,<span class="comment">//分享朋友圈</span></div><div class="line">		<span class="string">'onMenuShareAppMessage'</span>,<span class="comment">//发送给朋友</span></div><div class="line">		<span class="string">'openLocation'</span>,<span class="comment">//地图</span></div><div class="line">		<span class="string">'showOptionMenu'</span><span class="comment">//开启右上角按钮内页面分享按钮</span></div><div class="line">	]</div><div class="line">&#125;);</div><div class="line"></div><div class="line">wx.ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// 1 判断当前版本是否支持指定 JS 接口，支持批量判断</span></div><div class="line">	wx.checkJsApi(&#123;</div><div class="line">		<span class="attr">jsApiList</span>: [<span class="string">'getNetworkType'</span>, <span class="string">'previewImage'</span>],</div><div class="line">		<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">	<span class="comment">// 地理位置</span></div><div class="line">	<span class="built_in">document</span>.querySelector(<span class="string">'#openLocation'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		wx.openLocation(&#123;</div><div class="line">			<span class="attr">latitude</span>: <span class="number">22.537180</span>,<span class="comment">//纬度</span></div><div class="line">			longitude: <span class="number">113.976250</span>,<span class="comment">//经度</span></div><div class="line">			name: <span class="string">'xxxx酒店'</span>,<span class="comment">//位置名</span></div><div class="line">			address: <span class="string">'地址说明'</span>,</div><div class="line">			<span class="attr">scale</span>: <span class="number">14</span>,<span class="comment">//地图缩放级别范围从1~28</span></div><div class="line">			infoUrl: <span class="string">''</span><span class="comment">//在查看位置界面底部显示的超链接,可点击跳转</span></div><div class="line">		&#125;);</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="comment">// 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口</span></div><div class="line">	wx.onMenuShareAppMessage(&#123;</div><div class="line">		<span class="attr">title</span>: <span class="string">'分享标题'</span>,</div><div class="line">		<span class="attr">desc</span>: <span class="string">'分享简介'</span>,</div><div class="line">		<span class="attr">link</span>: <span class="string">'https://www.baidu.com'</span>,<span class="comment">//分享地址</span></div><div class="line">		imgUrl: <span class="string">'http://oalg33nuc.bkt.clouddn.com/image/wechatshareimg.jpg'</span>,<span class="comment">//分享图片的地址</span></div><div class="line">	&#125;);</div><div class="line"></div><div class="line">	<span class="comment">// 2.2 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口</span></div><div class="line">	wx.onMenuShareTimeline(&#123;</div><div class="line">		<span class="attr">title</span>: <span class="string">'分享标题'</span>,</div><div class="line">		<span class="attr">desc</span>: <span class="string">'分享简介'</span>,</div><div class="line">		<span class="attr">link</span>: <span class="string">'https://www.baidu.com'</span>,<span class="comment">//分享地址</span></div><div class="line">		imgUrl: <span class="string">'http://oalg33nuc.bkt.clouddn.com/image/wechatshareimg.jpg'</span>,<span class="comment">//分享图片的地址</span></div><div class="line">	&#125;);</div><div class="line">	</div><div class="line">	wx.showOptionMenu();<span class="comment">//显示微信右上角点开的分享按钮</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这一块前端网页还是比较简单的，因为所需要的<code>签名signature</code>等参数都是后台算好给的。生成签名需要<code>jsapi_ticket</code>，要拿到<code>jsapi_ticket</code>需要<code>access_token</code>，获取<code>access_token</code>的步骤和在iOS原生应用中做微信分享是一样的，拿<code>appid</code>和<code>secret</code>等参数调用接口获取<code>access_token</code>。</p>
<h3 id="分享按钮显示-隐藏"><a href="#分享按钮显示-隐藏" class="headerlink" title="分享按钮显示/隐藏"></a>分享按钮显示/隐藏</h3><p>分享按钮的显示问题，有时候要求只要指定页面分享出去，其他页面不能要分享，要隐藏掉分享按钮(发给朋友/分享到朋友圈/复制链接/收藏/邮件等等等)。</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="https://github.com/mxdios/notebook/blob/master/notebooks/images/WechatIMG65.jpeg?raw=true" alt="显示按钮"></th>
<th style="text-align:center"><img src="https://github.com/mxdios/notebook/blob/master/notebooks/images/WechatIMG66.jpeg?raw=true" alt="隐藏按钮"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>显示的页面需要在<code>wx.config</code>的<code>jsApiList:[]</code>里面添加<code>showOptionMenu</code>。并调用<code>wx.showOptionMenu();</code>显示方法。</p>
<p>隐藏的页面需要在<code>wx.config</code>的<code>jsApiList:[]</code>里面添加<code>hideOptionMenu</code>。并调用<code>wx.hideOptionMenu();</code>隐藏方法。</p>
<p>有隐藏就要对应有显示，比如第一个页面不作操作默认显示。第二个页面隐藏了，返回第一个页面分享按钮也会被隐藏。所以第一个页面要有显示调用。</p>
<h2 id="MUI的Picker使用问题"><a href="#MUI的Picker使用问题" class="headerlink" title="MUI的Picker使用问题"></a>MUI的Picker使用问题</h2><h3 id="调用MUI的Picker"><a href="#调用MUI的Picker" class="headerlink" title="调用MUI的Picker"></a>调用MUI的Picker</h3><p>用的MUI框架里的picker，调用起来还是很方便的，<code>layer: 2</code>是联级数量，支持多级picker，如果是单级的layer省略不写。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cityPicker = <span class="keyword">new</span> $.PopPicker(&#123;</div><div class="line">	<span class="attr">layer</span>: <span class="number">2</span></div><div class="line">&#125;);</div><div class="line">cityPicker.setData(cityData);</div><div class="line"><span class="keyword">var</span> showCityPickerButton = <span class="built_in">document</span>.getElementById(<span class="string">'showCityPicker'</span>);</div><div class="line"><span class="keyword">var</span> cityResult = <span class="built_in">document</span>.getElementById(<span class="string">'selectCityContent'</span>);</div><div class="line">showCityPickerButton.addEventListener(<span class="string">'tap'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">	<span class="built_in">document</span>.activeElement.blur();</div><div class="line">	cityPicker.show(<span class="function"><span class="keyword">function</span>(<span class="params">items</span>) </span>&#123;</div><div class="line">		alert(items[<span class="number">0</span>].text + <span class="string">' '</span> + items[<span class="number">1</span>].text);<span class="comment">//点击确认时的选择结果</span></div><div class="line">		<span class="comment">//返回 false 可以阻止选择框的关闭</span></div><div class="line">		<span class="comment">//return false;</span></div><div class="line">	&#125;);</div><div class="line">&#125;, <span class="literal">false</span>);</div></pre></td></tr></table></figure>
<h3 id="PopPicker在软键盘弹出时不能完全隐藏"><a href="#PopPicker在软键盘弹出时不能完全隐藏" class="headerlink" title="PopPicker在软键盘弹出时不能完全隐藏"></a>PopPicker在软键盘弹出时不能完全隐藏</h3><p>用的时候还有点问题，在火狐浏览器里，picker的cell都挤在一起了，根本无法滑动。至于是什么原因我也没有研究，因为在微信内置浏览器里可以用。还有另一个bug是不能不改的，iOS中有问题，Android中没问题。就是在输入信息页面，直接点击靠近屏幕下边缘的输入框，页面向上偏移，滑动页面时原本隐藏的picker粗线了。如下左图，右图才是它该有的样子。</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="https://github.com/mxdios/notebook/blob/master/notebooks/images/WechatIMG67.jpeg?raw=true" alt="picker出现了"></th>
<th style="text-align:center"><img src="https://github.com/mxdios/notebook/blob/master/notebooks/images/WechatIMG68.jpeg?raw=true" alt="正常的样子，不该出现"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>需要在mui.poppicker.js中增加初始化、show和hide方法中display的改变。解决办法如下，或见<a href="http://ask.dcloud.net.cn/article/603" target="_blank" rel="external">iOS键盘弹出后PopPicker出现的临时解决方法</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//init构造函数最后增加两行：</span></div><div class="line">self.panel.style.display = <span class="string">'none'</span>;</div><div class="line">self.body.style.display = <span class="string">'none'</span>;</div><div class="line"></div><div class="line"><span class="comment">//显示</span></div><div class="line">show: <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">	<span class="comment">//增加以下2行</span></div><div class="line">	self.panel.style.display = <span class="string">'block'</span>;</div><div class="line">	self.body.style.display = <span class="string">'block'</span>;</div><div class="line">	self.callback = callback;</div><div class="line">	self.mask.show();</div><div class="line">	<span class="built_in">document</span>.body.classList.add($.className(<span class="string">'poppicker-active-for-page'</span>));</div><div class="line">	self.panel.classList.add($.className(<span class="string">'active'</span>));</div><div class="line">	<span class="comment">//处理物理返回键</span></div><div class="line">	self.__back = $.back;</div><div class="line">	$.back = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		self.hide();</div><div class="line">	&#125;;</div><div class="line">&#125;,</div><div class="line"><span class="comment">//隐藏</span></div><div class="line">hide: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">if</span> (self.disposed) <span class="keyword">return</span>;</div><div class="line">	self.panel.classList.remove($.className(<span class="string">'active'</span>));</div><div class="line">	self.mask.close();</div><div class="line">	<span class="built_in">document</span>.body.classList.remove($.className(<span class="string">'poppicker-active-for-page'</span>));</div><div class="line">	</div><div class="line">	<span class="comment">//增加以下2行</span></div><div class="line">	self.panel.style.display = <span class="string">'none'</span>;</div><div class="line">	self.body.style.display = <span class="string">'none'</span>;</div><div class="line">	</div><div class="line">	<span class="comment">//处理物理返回键</span></div><div class="line">	$.back=self.__back;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="MUI的样式mui-min-css与微信的weui-min-css冲突"><a href="#MUI的样式mui-min-css与微信的weui-min-css冲突" class="headerlink" title="MUI的样式mui.min.css与微信的weui.min.css冲突"></a>MUI的样式mui.min.css与微信的weui.min.css冲突</h3><p>因为做的是微信内置网页，所以使用了微信提供的<code>weui.min.css</code>样式，在做picker的时候，需要导入MUI的<code>mui.min.css</code>样式。这样一来<code>weui.min.css</code>里的很多div样式被覆盖了，写好的样式变成一团糟。只能放弃使用<code>mui.min.css</code>。</p>
<p>因为只用了picker，<code>mui.min.css</code>的作用并不多，只有在picker出现时，后面的半透明蒙版。去掉<code>mui.min.css</code>后，这层蒙版便不再出现了。这个问题还是挺大的，影响交互，picker显示时，还可以编辑输入框。</p>
<p>阅遍<code>mui.min.css</code>终于找到这层蒙版的样式控制，把下面这段css代码拿出来，放到自定义的css样式内即可。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.mui-backdrop</span> &#123;</div><div class="line">	<span class="attribute">position</span>: fixed;</div><div class="line">	<span class="attribute">z-index</span>: <span class="number">998</span>;</div><div class="line">	<span class="attribute">top</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">right</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">bottom</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">background-color</span>: <span class="built_in">rgba</span>(0, 0, 0, .3)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="iOS第三方输入法遮盖输入框"><a href="#iOS第三方输入法遮盖输入框" class="headerlink" title="iOS第三方输入法遮盖输入框"></a>iOS第三方输入法遮盖输入框</h2><p>这是一个非常头疼的问题，之前一直没有发现，因为我根本不用第三方输入法。iOS原生输入法已经很强大了，搞不懂为什么还有人用搜狗百度之流的垃圾输入法，难道仅仅为了皮肤吗？Too naive。</p>
<p>即使用其他输入法，按顺序点击输入框，或者点击网页内弹出的软键盘上面自带工具条上的左右箭头键，切换输入框，这样操作也不会出现输入法遮盖输入框问题。而且这个问题在Android上也不存在。</p>
<p>唯独，一上来就点击页面底下的输入框，第三方输入法弹出缓慢，页面偏移距离计算错误，出现了输入法遮盖输入框的问题。好多网页出现这种问题，比如：各大门户网站的登录界面。</p>
<p>解决办法有点low，但还是比较完美的解决了这个bug，定义js方法:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">	SCROLLY = <span class="number">300</span>;</div><div class="line">	TIMER_NAME = <span class="number">200</span>;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">textfocusClick</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="keyword">if</span>(<span class="built_in">window</span>.scrollY &lt; SCROLLY) &#123;</div><div class="line">				<span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">400</span>);</div><div class="line">			&#125;</div><div class="line">		&#125;, TIMER_NAME)</div><div class="line">	&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p>会被输入法遮盖的输入框调用方法:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"userNameInput"</span> <span class="attr">onclick</span>=<span class="string">"textfocusClick()"</span> <span class="attr">placeholder</span>=<span class="string">"请输入"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>定义的js方法，第三方输入法弹出时window.scrollY的值小于系统输入法弹出的，我大致试验出一个300的值(网络上给出的100等小值根本不行)。如果小于这个值就说明是第三方输入法首次弹出，要偏移页面<code>window.scrollTo(0, 400);</code>，偏移的数值根据需要设定。输入法本身就弹出了，再切换输入框，window.scrollY值会和系统输入法的一样，不会小于SCROLLY，所以不能偏移页面。因为网页会自动偏移，再进行代码偏移，会出现页面闪动。</p>
<p>输入框添加的是<code>onclick</code>点击事件，只有在点击输入框获取焦点的时候才调用，在用工具条上的切换按钮切换输入框焦点时不会调用。</p>
<h2 id="警示框的悬浮显示"><a href="#警示框的悬浮显示" class="headerlink" title="警示框的悬浮显示"></a>警示框的悬浮显示</h2><p>警示框不固定在页面上，不随页面滑动而滑动，要求悬浮在导航条下面。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">	<span class="built_in">window</span>.onscroll = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> box = <span class="built_in">document</span>.getElementById(<span class="string">"box"</span>);</div><div class="line">		<span class="keyword">var</span> t = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop;</div><div class="line">		box.style.top = t + <span class="string">"px"</span>;</div><div class="line">	&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p>设置警示框div的id为<code>box</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"position:absolute;width: 100%;height: 45px; left: 0px;"</span> <span class="attr">id</span>=<span class="string">"box"</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="placeholder样式"><a href="#placeholder样式" class="headerlink" title="placeholder样式"></a>placeholder样式</h2><p>自定义输入框placeholder的文字样式，包括字号大小，字体颜色等，css样式如下。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* all */</span></div><div class="line"><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123;<span class="attribute">font-size</span>: <span class="number">16px</span>; <span class="attribute">padding-top</span>: <span class="number">2px</span>;&#125;</div><div class="line"><span class="selector-pseudo">::-moz-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#f00</span>; &#125;  <span class="selector-tag">firefox</span> 19+ </div><div class="line"><span class="selector-pseudo">:-ms-input-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#f00</span>; &#125; <span class="comment">/* ie */</span></div><div class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-moz-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#f00</span>; &#125;</div><div class="line"></div><div class="line"><span class="comment">/* individual: webkit */</span></div><div class="line"><span class="selector-id">#field2</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#00f</span>; &#125;</div><div class="line"><span class="selector-id">#field3</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#090</span>; <span class="attribute">background</span>:lightgreen; <span class="attribute">text-transform</span>:uppercase; &#125;</div><div class="line"><span class="selector-id">#field4</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123; <span class="attribute">font-style</span>:italic; <span class="attribute">text-decoration</span>:overline; <span class="attribute">letter-spacing</span>:<span class="number">3px</span>; <span class="attribute">color</span>:<span class="number">#999</span>; &#125;</div><div class="line"></div><div class="line"><span class="comment">/* individual: mozilla */</span></div><div class="line"><span class="selector-id">#field2</span><span class="selector-pseudo">::-moz-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#00f</span>; &#125;</div><div class="line"><span class="selector-id">#field3</span><span class="selector-pseudo">::-moz-placeholder</span> &#123; <span class="attribute">color</span>:<span class="number">#090</span>; <span class="attribute">background</span>:lightgreen; <span class="attribute">text-transform</span>:uppercase; &#125;</div><div class="line"><span class="selector-id">#field4</span><span class="selector-pseudo">::-moz-placeholder</span> &#123; <span class="attribute">font-style</span>:italic; <span class="attribute">text-decoration</span>:overline; <span class="attribute">letter-spacing</span>:<span class="number">3px</span>; <span class="attribute">color</span>:<span class="number">#999</span>; &#125;</div></pre></td></tr></table></figure>
<h2 id="正则使用"><a href="#正则使用" class="headerlink" title="正则使用"></a>正则使用</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myreg = <span class="regexp">/^(((13[0-9]&#123;1&#125;)|(15[0-9]&#123;1&#125;)|(17[0-9]&#123;1&#125;)|(18[0-9]&#123;1&#125;))+\d&#123;8&#125;)$/</span>;</div><div class="line"><span class="keyword">if</span>(myreg.test(phoneNumText)) &#123;</div><div class="line">	alert(<span class="string">"手机号正确"</span>)；</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div><iframe src="/donate/?AliPayQR=http://oalg33nuc.bkt.clouddn.com/WechatIMG766.jpeg&amp;WeChatQR=http://oalg33nuc.bkt.clouddn.com/WechatIMG767.jpeg&amp;GitHub=https://github.com/mxdios&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden;overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/tags/HTML5/">HTML5</a></div><div class="post-nav"><a href="/2016/11/30/我想做个APP，多长时间，多少钱/" class="pre">我想做个APP，多长时间，多少钱</a><a href="/2016/11/22/记四天的香港旅程/" class="next">记四天的香港旅程</a></div><div id="uyan_frame"></div><script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2140361"></script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://markmiao.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML5/">HTML5</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS开发/">iOS开发</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/macOS开发/">macOS开发</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/程序人生/">程序人生</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/记事/">记事</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/总结/" style="font-size: 15px;">总结</a> <a href="/tags/Quartz2D/" style="font-size: 15px;">Quartz2D</a> <a href="/tags/swift/" style="font-size: 15px;">swift</a> <a href="/tags/文档/" style="font-size: 15px;">文档</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/游记/" style="font-size: 15px;">游记</a> <a href="/tags/iOS10/" style="font-size: 15px;">iOS10</a> <a href="/tags/ipa/" style="font-size: 15px;">ipa</a> <a href="/tags/应用/" style="font-size: 15px;">应用</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/RxSwift/" style="font-size: 15px;">RxSwift</a> <a href="/tags/短文/" style="font-size: 15px;">短文</a> <a href="/tags/静态库/" style="font-size: 15px;">静态库</a> <a href="/tags/HTML5/" style="font-size: 15px;">HTML5</a> <a href="/tags/小程序/" style="font-size: 15px;">小程序</a> <a href="/tags/AppStore/" style="font-size: 15px;">AppStore</a> <a href="/tags/碎碎念/" style="font-size: 15px;">碎碎念</a> <a href="/tags/私有API/" style="font-size: 15px;">私有API</a> <a href="/tags/APP开发/" style="font-size: 15px;">APP开发</a> <a href="/tags/外包/" style="font-size: 15px;">外包</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/12/01/duoyuyan/">APP多语言开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/26/sycjlxj/">十一长假旅行记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/24/rxswiftlearn1/">RxSwift学习笔记(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/13/apidoc/">用apiDoc写接口文档</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/talkingtoapple/">被苹果爸爸完全碾压的通话记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/03/mymacbooks/">那些年用过的Mac</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/27/macosapprejected/">macOS应用上架被拒</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/26/stenonote/">速记 - 快速记录每一段文字</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/26/ipachongqianming/">ipa重签名</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/22/dongdaihezhilv/">东戴河之旅</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Mark Miao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3a6b5f9b69c85227a288646d3403af6e";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>